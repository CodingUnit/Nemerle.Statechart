//flags : debug;
  name SaveChecking;
  
  0 / IsNew = false => WantToSave;
  
  cancel => (X) cancel; // exit point cancel
  
  
  entry: save => Overwrite; // entry point syntax 1
  save_as:    => SaveAs;    // entry point syntax 2
  new: / IsNew = true => WantToSave;
  
  state WantToSave
  {
    do / ViewDialog(ViewWantToSave);
    Yes => {
             IsNew => SaveAs;
             else  => Overwrite;
           }
           
    No  => $0;
  }
    
  state Overwrite
  {
    do / ViewDialog(ViewOverwrite);
    Yes => SaveCurrentFile;
    No  => SaveAs;
  }
    
  state SaveCurrentFile
  {
    do / DoActionComplete(SaveCurrentFile);
    OK => $0;
  }
    
  state SaveAs
  {
    entry / SaveDialog.FileName = CurFile;
      
    do / ViewDialog(ViewSaveAsDialog);
    OK / CurFile = SaveDialog.FileName => SaveCurrentFile;
  }