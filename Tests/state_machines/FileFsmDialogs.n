using Nemerle;
using Nemerle.Collections;
using Nemerle.Text;
using Nemerle.Utility;

using System;
using System.Collections.Generic;
using System.Linq;

namespace Nemerle.Statechart.Tests
{
  /// <summary>
  /// Description of FileFsmDialogs.
  /// </summary>
  [statechart(<#
  
  submachine SaveChecking : FileDialogs
  {
    _ => $0;
    exit: cancel => merge_cancel;
  }
  
  state FileDialogs
  {
    _      => Interface;
    cancel => Interface.H;
    
    state Opening
    {
      _ => final;
      
      submachine SaveChecking
      {
        _ => OpenDialog;
        exit: cancel => merge_cancel;
      }
    }
    
    state OpenDialog : Opening
    {
      _ => $0;
      
      state ViewOpenDialog
      {
        do / ViewDialog(ViewOpenDialog);
        OK / CurFile = OpenDialog.FileName => OpenFile;
      }
      
      state OpenFile
      {
        do / DoActionComplete(OnOpenFileAction);
        OK => $0;
      }
    }
    
    state NewCreating
    {
      _ => NotSaved;
      
      submachine SaveChecking
      {
        _ => NewDialog;
        exit: cancel => merge_cancel;
      }
    }
    
    state NewDialog : NewCreating
    {
      _ => $0;
      
      state ViewNewDialog
      {
        do / DoActionComplete(ViewNewDialog);
        OK => NewDialogAction;
      }
      
      state NewDialogAction
      {
        do / DoActionComplete(OnNewFileAction);
        OK => $0;
      }
    }
    
    state Exiting
    {
      _ => X;
    }
    
    submachine SaveChecking : Exiting
    {
      _ => $0;
      exit: cancel => merge_cancel;
    }
  }

  #>
  )]
  public partial class FileFsm
  {
  }
}
